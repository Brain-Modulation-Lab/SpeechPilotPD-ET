function electrodeLocations = readElectrodeLocXLS(filepath)
% function electrodeLocations = readElectrodeLocXLS(filepath)
%
% Reads in an excel spreadsheet format that gives labels for all of the 
% ECoG electrode locations based on the localization.

[~,~,raw] = xlsread(filepath); %returns cell array of 

entryRows = find(strncmpi('DBS',raw(:,1), 3)); 
for ii=1:length(entryRows)
    er = entryRows(ii);
    nch = raw{entryRows(ii)+2,1};
    loc.subject = raw{er,1};
    loc.side = raw{er+1,1};
    loc.nchannel = raw{er+2,1};
    switch nch
        case 6
            labels = raw(er-1+(1:6),3); %Anatomical labels
            nums = raw{er-1+(1:6),3}; %Channel numbers (important to denote if multiple strips)
        case 28
            for jj=1:2 %rows of electrodes in strip
                inds = (jj-1)*14+(1:14);
                labels(inds) = raw(er-1+(1:14),(2*jj)+1);
                nums(inds) = raw{er-1+(1:14),(2*jj)+1};
            end
        case 54
            for jj=1:3 %rows of electrodes in strip
                inds = (jj-1)*18+(1:18);
                labels(inds) = raw(er-1+(1:14),(2*jj)+1);
                nums(inds) = raw{er-1+(1:14),(2*jj)+1};
            end
            labels = raw(er-1+(1:18),3);
            labels(19:36) = raw(er-1+(1:18),5);
            labels(37:54) = raw(er-1+(1:18),7);
    end
    loc.labels  = labels;
    electrodeLocations(ii) = loc;
end